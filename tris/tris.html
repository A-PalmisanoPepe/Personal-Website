<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Tris</title>
        <link rel="stylesheet" href="tris-style.css">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap" rel="stylesheet">
    </head>
    <body>
        <div class="page" id='introduction'>
            <a href="tris.html#choise-sign"><button>Fai una partita a Tris!</button></a>
        </div>
        <div class="page" id='choise-sign'>
            <a href="tris.html#introduction"><button class='close' onclick="window.location.reload()">&Cross;</button></a>
            <div class="sheet">
            <h2>Scegli il segno</h2>
            <div class="choise">
            <a href="tris.html#match"><button id="x">x</button></a>
            <a href="tris.html#match"><button id="o">o</button></a>
            </div>
            </div>
            <a href="tris.html#introduction"><button class='turn-back' onclick="window.location.reload()">&ldca;</button></a>
        </div>
        <div class="page" id='match'>
            <a href="tris.html#introduction"><button class='close' onclick="window.location.reload()">&Cross;</button></a>
            <div class="sheet">
            <table>
                <tr>
                    <td id="cell1">&nbsp;</td><td id="cell2" class="central-column">&nbsp;</td><td id="cell3">&nbsp;</td>
                </tr>
                <tr>
                    <td id="cell4" class="central-row">&nbsp;</td><td id="cell5"class="central-column central-row">&nbsp;</td><td id="cell6" class="central-row">&nbsp;</td>
                </tr>
                <tr>
                    <td id="cell7">&nbsp;</td><td id="cell8" class="central-column">&nbsp;</td><td id="cell9">&nbsp;</td>
                </tr>
            </table>
            </div>
            <a href="tris.html#choise-sign"><button class='turn-back' onclick="window.location.reload()">&ldca;</button></a>
        </div>
        <div class="page" id="result">
            <a href="tris.html#introduction"><button class='close' onclick="window.location.reload()">&Cross;</button></a>
            <div class="sheet">
                <h2 id="your-result"></h2>
                <a href="tris.html#choise-sign"><button class="play-again" onclick="window.location.reload()">Gioca ancora!</button></a>
            </div>
            <a href="tris.html#match"><button class='turn-back'>&ldca;</button></a>
        </div>
    
    </body>
    <script>
        let signX = document.querySelector('#x');
        let signO = document.querySelector('#o');
        let table = document.querySelector('table');
        let cells = document.querySelectorAll('td');
        let cell1 = cells[0];
        let cell2 = cells[1];
        let cell3 = cells[2];
        let cell4 = cells[3];
        let cell5 = cells[4];
        let cell6 = cells[5];
        let cell7 = cells[6];
        let cell8 = cells[7];
        let cell9 = cells[8];
        let yourResult = document.querySelector('#your-result');
        let resultPage = document.querySelector('#result');
        let sign;
        let oppositeSign;
        let tie = true;

        function chooseX() {
             sign = 'x';
             oppositeSign = 'o';
        }

        signX.addEventListener('click', chooseX);

        function chooseO() {
             sign = 'o';
             oppositeSign = 'x';
        }

        signO.addEventListener('click', chooseO);

        function youWin() {
            yourResult.textContent = 'Hai vinto!';
            window.setTimeout(function() {
                resultPage.scrollIntoView();
            }, 1000);
        }

        function youLose() {
            yourResult.textContent = 'Hai perso.';
            window.setTimeout(function() {
                resultPage.scrollIntoView();
            }, 1000);
        }

        function youDraw() {
            yourResult.textContent = 'Pareggio!';
            window.setTimeout(function() {
                resultPage.scrollIntoView();
            }, 1000);
        }

        function checkWin() {   
            if(cell1.textContent===sign && cell2.textContent===sign && cell3.textContent===sign) {
                cell1.style.color = 'aquamarine';
                cell2.style.color = 'aquamarine';
                cell3.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if(cell1.textContent===sign && cell4.textContent===sign && cell7.textContent===sign) {
                cell1.style.color = 'aquamarine';
                cell4.style.color = 'aquamarine';
                cell7.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if (cell1.textContent===sign && cell5.textContent===sign && cell9.textContent===sign) {
                cell1.style.color = 'aquamarine';
                cell5.style.color = 'aquamarine';
                cell9.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if (cell2.textContent===sign && cell5.textContent===sign && cell8.textContent===sign) {
                cell2.style.color = 'aquamarine';
                cell5.style.color = 'aquamarine';
                cell8.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if (cell3.textContent===sign && cell6.textContent===sign && cell9.textContent===sign) {
                cell3.style.color = 'aquamarine';
                cell6.style.color = 'aquamarine';
                cell9.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if (cell3.textContent===sign && cell5.textContent===sign && cell7.textContent===sign) {
                cell3.style.color = 'aquamarine';
                cell5.style.color = 'aquamarine';
                cell7.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if (cell4.textContent===sign && cell5.textContent===sign && cell6.textContent===sign) {
                cell4.style.color = 'aquamarine';
                cell5.style.color = 'aquamarine';
                cell6.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } else if (cell7.textContent===sign && cell8.textContent===sign && cell9.textContent===sign) {
                cell7.style.color = 'aquamarine';
                cell8.style.color = 'aquamarine';
                cell9.style.color = 'aquamarine';
                sign = ' ';
                oppositeSign = ' ';
                tie = false;
                youWin();
            } 
        }

        function checkLoss() { 
            if(cell1.textContent===oppositeSign && cell2.textContent===oppositeSign && cell3.textContent===oppositeSign) {
                cell1.style.color = 'salmon';
                cell2.style.color = 'salmon';
                cell3.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } else if(cell1.textContent===oppositeSign && cell4.textContent===oppositeSign && cell7.textContent===oppositeSign) {
                cell1.style.color = 'salmon';
                cell4.style.color = 'salmon';
                cell7.style.color = 'salmon';
                sign = ' ';
                tie = false;
                youLose();  
            } else if (cell1.textContent===oppositeSign && cell5.textContent===oppositeSign && cell9.textContent===oppositeSign) {
                cell1.style.color = 'salmon';
                cell5.style.color = 'salmon';
                cell9.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } else if (cell2.textContent===oppositeSign && cell5.textContent===oppositeSign && cell8.textContent===oppositeSign) {
                cell2.style.color = 'salmon';
                cell5.style.color = 'salmon';
                cell8.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } else if (cell3.textContent===oppositeSign && cell6.textContent===oppositeSign && cell9.textContent===oppositeSign) {
                cell3.style.color = 'salmon';
                cell6.style.color = 'salmon';
                cell9.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } else if (cell3.textContent===oppositeSign && cell5.textContent===oppositeSign && cell7.textContent===oppositeSign) {
                cell3.style.color = 'salmon';
                cell5.style.color = 'salmon';
                cell7.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } else if (cell4.textContent===oppositeSign && cell5.textContent===oppositeSign && cell6.textContent===oppositeSign) {
                cell4.style.color = 'salmon';
                cell5.style.color = 'salmon';
                cell6.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } else if (cell7.textContent===oppositeSign && cell8.textContent===oppositeSign && cell9.textContent===oppositeSign) {
                cell7.style.color = 'salmon';
                cell8.style.color = 'salmon';
                cell9.style.color = 'salmon';
                sign = ' '; 
                tie = false;
                youLose(); 
            } 
        }

        function checkTie() {
            if(tie===true&&cell1.textContent!=='\u00A0'&&cell2.textContent!=='\u00A0'&&cell3.textContent!=='\u00A0'&&cell4.textContent!=='\u00A0'&&cell5.textContent!=='\u00A0'&&cell6.textContent!=='\u00A0'&&cell7.textContent!=='\u00A0'&&cell8.textContent!=='\u00A0'&&cell9.textContent!=='\u00A0') {
                youDraw(); 
            }
        }

        function startCheckLoss() {
            window.setTimeout(checkLoss, 200);    
        }

        function startCheckTie() {
            window.setTimeout(checkTie, 600); 
        }

        function printSign(e) {
            
            let randomId =Math.floor(Math.random() *(cells.length));

            if(e.target.matches('#cell1') && cell1.textContent !== oppositeSign && cell1.textContent !== sign) {
                cell1.textContent = sign;
                
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell2.textContent === sign && cell3.textContent ==='\u00A0') {
                        cell3.textContent = oppositeSign; break;
                    } else if(cell3.textContent === sign && cell2.textContent ==='\u00A0') {
                        cell2.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell9.textContent ==='\u00A0') {
                        cell9.textContent = oppositeSign; break;
                    } else if(cell9.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cell4.textContent === sign && cell7.textContent ==='\u00A0') {
                        cell7.textContent = oppositeSign; break;
                    } else if(cell7.textContent === sign && cell4.textContent ==='\u00A0') {
                        cell4.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }  
                }
        
            } else if(e.target.matches('#cell2') && cell2.textContent !== oppositeSign && cell2.textContent !== sign) {
                cell2.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell1.textContent === sign && cell3.textContent ==='\u00A0') {
                        cell3.textContent = oppositeSign; break;
                    } else if(cell3.textContent === sign && cell1.textContent ==='\u00A0') {
                        cell1.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell8.textContent ==='\u00A0') {
                        cell8.textContent = oppositeSign; break;
                    } else if(cell8.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    } 
                }
               
            } else if(e.target.matches('#cell3') && cell3.textContent !== oppositeSign && cell3.textContent !== sign) {
                cell3.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell2.textContent === sign && cell1.textContent ==='\u00A0') {
                        cell1.textContent = oppositeSign; break;
                    } else if(cell1.textContent === sign && cell2.textContent ==='\u00A0') {
                        cell2.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell7.textContent ==='\u00A0') {
                        cell7.textContent = oppositeSign; break;
                    } else if(cell7.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cell6.textContent === sign && cell9.textContent ==='\u00A0') {
                        cell9.textContent = oppositeSign; break;
                    } else if(cell9.textContent === sign && cell6.textContent ==='\u00A0') {
                        cell6.textContent = oppositeSign; break;
                    } else
                    if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
           
            } else if(e.target.matches('#cell4') && cell4.textContent !== oppositeSign && cell4.textContent !== sign) {
                cell4.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell1.textContent === sign && cell7.textContent ==='\u00A0') {
                        cell7.textContent = oppositeSign; break;
                    } else if(cell7.textContent === sign && cell1.textContent ==='\u00A0') {
                        cell1.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell6.textContent ==='\u00A0') {
                        cell6.textContent = oppositeSign; break;
                    } else if(cell6.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
             
            } else if(e.target.matches('#cell5') && cell5.textContent !== oppositeSign && cell5.textContent !== sign) {
                cell5.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell1.textContent === sign && cell9.textContent ==='\u00A0') {
                        cell9.textContent = oppositeSign; break;
                    } else if(cell9.textContent === sign && cell1.textContent ==='\u00A0') {
                        cell1.textContent = oppositeSign; break;
                    } else if(cell2.textContent === sign && cell8.textContent ==='\u00A0') {
                        cell8.textContent = oppositeSign; break;
                    } else if(cell8.textContent === sign && cell2.textContent ==='\u00A0') {
                        cell2.textContent = oppositeSign; break;
                    } else if(cell7.textContent === sign && cell3.textContent ==='\u00A0') {
                        cell3.textContent = oppositeSign; break;
                    } else if(cell3.textContent === sign && cell7.textContent ==='\u00A0') {
                        cell7.textContent = oppositeSign; break;
                    } else if(cell4.textContent === sign && cell6.textContent ==='\u00A0') {
                        cell6.textContent = oppositeSign; break;
                    } else if(cell6.textContent === sign && cell4.textContent ==='\u00A0') {
                        cell4.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
         
            } else if(e.target.matches('#cell6') && cell6.textContent !== oppositeSign && cell6.textContent !== sign) {
                cell6.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell9.textContent === sign && cell3.textContent ==='\u00A0') {
                        cell3.textContent = oppositeSign; break;
                    } else if(cell3.textContent === sign && cell9.textContent ==='\u00A0') {
                        cell9.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell4.textContent ==='\u00A0') {
                        cell4.textContent = oppositeSign; break;
                    } else if(cell4.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
           
            } else if(e.target.matches('#cell7') && cell7.textContent !== oppositeSign && cell7.textContent !== sign) {
                cell7.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell4.textContent === sign && cell1.textContent ==='\u00A0') {
                        cell1.textContent = oppositeSign; break;
                    } else if(cell1.textContent === sign && cell4.textContent ==='\u00A0') {
                        cell4.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell3.textContent ==='\u00A0') {
                        cell3.textContent = oppositeSign; break;
                    } else if(cell3.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cell8.textContent === sign && cell9.textContent ==='\u00A0') {
                        cell9.textContent = oppositeSign; break;
                    } else if(cell9.textContent === sign && cell8.textContent ==='\u00A0') {
                        cell8.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
              
            } else if(e.target.matches('#cell8') && cell8.textContent !== oppositeSign && cell8.textContent !== sign) {
                cell8.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell2.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell2.textContent ==='\u00A0') {
                        cell2.textContent = oppositeSign; break;
                    } else if(cell7.textContent === sign && cell9.textContent ==='\u00A0') {
                        cell9.textContent = oppositeSign; break;
                    } else if(cell9.textContent === sign && cell7.textContent ==='\u00A0') {
                        cell7.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
             
            } else if(e.target.matches('#cell9') && cell9.textContent !== oppositeSign && cell9.textContent !== sign) {
                cell9.textContent = sign;
                for(i=0;;i++) {
                    checkWin();
                    startCheckLoss();
                    startCheckTie();
                    if(cell6.textContent === sign && cell3.textContent ==='\u00A0') {
                        cell3.textContent = oppositeSign; break;
                    } else if(cell3.textContent === sign && cell6.textContent ==='\u00A0') {
                        cell6.textContent = oppositeSign; break;
                    } else if(cell5.textContent === sign && cell1.textContent ==='\u00A0') {
                        cell1.textContent = oppositeSign; break;
                    } else if(cell1.textContent === sign && cell5.textContent ==='\u00A0') {
                        cell5.textContent = oppositeSign; break;
                    } else if(cell8.textContent === sign && cell7.textContent ==='\u00A0') {
                        cell7.textContent = oppositeSign; break;
                    } else if(cell7.textContent === sign && cell8.textContent ==='\u00A0') {
                        cell8.textContent = oppositeSign; break;
                    } else if(cells[randomId].textContent ==='\u00A0') {
                        cells[randomId].textContent = oppositeSign; break;
                    } else if(randomId < cells.length){
                        randomId += 1;
                    } else if(randomId === cells.length){
                        randomId -= 1;
                    }
                }
              
            }
        }

        table.addEventListener('click', printSign);

    </script>
</html>